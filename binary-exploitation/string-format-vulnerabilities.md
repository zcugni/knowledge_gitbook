# Format string vulnerabilities

## Explanation

* Whenever a format function is used \(like `printf`\), we can abuse it **if we control the format part**
* For each specifier, printf will read the memory at the current stack pointer and interpret it according to the specifier
* It has a variable number of arguments, so it blindly follows the specifiers
  * If we provide more than there's parameters, it will read the stack
* `%x` Can be used to read the stack in hexadecimal
* `%s` Can be used to :
  * **Crash the program**. It'll try to interpret any data as a memory address, so it might get a non-existent one, or one in protected space, and crash
  * **Read any memory location**. Since we control the format string, and it's pushed to the stack, we can insert an address in it and then use %s to read it : `printf(“\xef\xbe\xad\xde %x %x %x %s”, A, B, C);`
    * Will read the address at 0xdeadbeef
    * The `%x` are placeholders used to move the stack pointer to the format string \(since there's 3 parameters before it because of A, B & C\)
* `%n` Can be use to **write in any memory location**
  * It will write the number of characters written so far into the memory address pointed by it's variable
  * We can use the same trick as with `%s`, just replace it by `%n` in the above example to write at 0xdeadbeef
* Use **length modifiers** to write many chars with a few one \(for example `%64d` write 64 chars\)

## Sources

* [A pdf](http://www.cis.syr.edu/~wedu/Teaching/cis643/LectureNotes_New/Format_String.pdf)
* [medium](https://medium.com/swlh/binary-exploitation-format-string-vulnerabilities-70edd501c5be)

