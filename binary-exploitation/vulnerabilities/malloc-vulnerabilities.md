# Malloc vulnerabilities

## Use after free

* Like its name indicate, this vulnerability appears if a variable is used after having been freed
* The "free" space will be allocated again at one point, and when the variable is used again, the data it points too will be the one of another variable \(which we might control\)

## Unlink exploit

* This vulnerability only exist in old version of the glibc malloc
* You'll need 2 allocations next to one another, and a buffer overflow in the 1st one
* If we free an allocated chunk next to another free one, they're merged together
  * Before merging them, the already free chunk is `unlink()` \(aka removed\), from the double linked list :

```c
#define unlink(P, BK, FD) {   \
  FD = P->fd;                 \
  BK = P->bk;                 \
  FD->bk = BK;                \
  BK->fd = FD;                \
}
```

* `->fd` & `->bk`  are both members of the `malloc_chunk` structure
  * They're respectively written at +8 & +12 bytes from the start of the structure
* If we can control the 

